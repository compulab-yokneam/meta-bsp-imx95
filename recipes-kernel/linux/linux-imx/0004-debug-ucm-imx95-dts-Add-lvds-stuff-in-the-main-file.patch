From 3127cf65ca010053ba2fcd4ca74b127d8abaa172 Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Fri, 8 Nov 2024 22:09:58 +0200
Subject: [PATCH 4/4] debug: ucm-imx95: dts: Add lvds stuff in the main file

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 arch/arm64/boot/dts/compulab/ucm-imx95.dts | 119 ++++++++++++++++++++-
 1 file changed, 118 insertions(+), 1 deletion(-)

diff --git a/arch/arm64/boot/dts/compulab/ucm-imx95.dts b/arch/arm64/boot/dts/compulab/ucm-imx95.dts
index 1caa9b513c3d..575ea34da93b 100644
--- a/arch/arm64/boot/dts/compulab/ucm-imx95.dts
+++ b/arch/arm64/boot/dts/compulab/ucm-imx95.dts
@@ -280,6 +280,49 @@ simple-audio-card,codec {
 			sound-dai = <&bt_sco_codec 1>;
 		};
 	};
+
+	backlight: backlight {
+		compatible = "pwm-backlight";
+		pwms = <&tpm4 2 6666667 PWM_POLARITY_INVERTED>;
+		brightness-levels = <0 45 63 88 119 158 203 255>;
+		default-brightness-level = <6>;
+	};
+
+	lvds0_panel {
+		compatible = "simple-panel";
+		backlight = <&backlight>;
+		enable-gpios = <&pca9555 3 GPIO_ACTIVE_HIGH>;
+		display-timings {
+			native-mode = <&timing0>;
+			timing0: timing0 {
+				clock-frequency = <42105000>;
+				hactive = <1024>;
+				vactive = <600>;
+				hfront-porch = <30>;
+				hback-porch = <30>;
+				hsync-len = <30>;
+				vback-porch = <10>;
+				vfront-porch = <10>;
+				vsync-len = <10>;
+
+				hsync-active = <0>;
+				vsync-active = <0>;
+				de-active = <1>;
+				pixelclk-active = <0>;
+			};
+		};
+		ports {
+			#address-cells = <1>;
+			#size-cells = <0>;
+
+			port@0 {
+				reg = <0>;
+				panel_in: endpoint {
+					remote-endpoint = <&lvds0_out>;
+				};
+			};
+		};
+	};
 };
 
 &adc1 {
@@ -1141,6 +1184,13 @@ IMX95_PAD_SD2_DATA3__USDHC2_DATA3			0x13fe
 			IMX95_PAD_SD2_VSELECT__USDHC2_VSELECT			0x51e
 		>;
 	};
+
+	pinctrl_tpm4: tpm4grp {
+		fsl,pins = <
+			IMX95_PAD_GPIO_IO13__TPM4_CH2	0x51e
+		>;
+	};
+
 };
 
 &vpuctrl {
@@ -1231,4 +1281,71 @@ &micfil {
 	status = "disabled";
 };
 
-#include "ucm-imx95-lvds.dtsi"
+&display_pixel_link {
+	status = "okay";
+};
+
+&dpu {
+	assigned-clocks = <&scmi_clk IMX95_CLK_DISP1PIX>,
+			  <&scmi_clk IMX95_CLK_VIDEOPLL1_VCO>,
+			  <&scmi_clk IMX95_CLK_VIDEOPLL1>;
+	assigned-clock-parents = <&scmi_clk IMX95_CLK_VIDEOPLL1>;
+	assigned-clock-rates = <0>, <4008000000>, <445333334>;
+	status = "okay";
+};
+
+&mipi_dsi {
+	status = "disabled";
+};
+
+&ldb {
+	#address-cells = <1>;
+	#size-cells = <0>;
+	assigned-clocks = <&scmi_clk IMX95_CLK_LDBPLL_VCO>,
+			  <&scmi_clk IMX95_CLK_LDBPLL>;
+	assigned-clock-rates = <2986200000>, <497700000>;
+	/* assigned-clock-rates = <3291120000>, <1097040000>; */
+	status = "okay";
+
+	channel@0 {
+		#address-cells = <1>;
+		#size-cells = <0>;
+		reg = <0>;
+		fsl,data-mapping = "spwg";
+		fsl,data-width = <24>;
+		status = "okay";
+
+		port@1 {
+			reg = <1>;
+
+			lvds0_out: endpoint {
+				remote-endpoint = <&panel_in>;
+			};
+		};
+	};
+};
+
+&ldb0_phy {
+	status = "okay";
+};
+
+&ldb1_phy {
+	status = "okay";
+};
+
+&pixel_interleaver {
+	#address-cells = <1>;
+	#size-cells = <0>;
+	status = "okay";
+
+	channel@0 {
+		reg = <0>;
+		status = "okay";
+	};
+};
+
+&tpm4 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_tpm4>;
+	status = "okay";
+};
-- 
2.34.1

