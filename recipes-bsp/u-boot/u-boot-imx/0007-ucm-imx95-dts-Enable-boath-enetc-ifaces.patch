From 7d14f5e6c01466d0037287e7614c70eae27a24d3 Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Fri, 1 Nov 2024 18:07:24 +0200
Subject: [PATCH] ucm-imx95: dts: Enable boath enetc ifaces

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 arch/arm/dts/ucm-imx95-u-boot.dtsi |  2 +-
 arch/arm/dts/ucm-imx95.dts         | 32 ++++++++++++++++++++----------
 2 files changed, 23 insertions(+), 11 deletions(-)

diff --git a/arch/arm/dts/ucm-imx95-u-boot.dtsi b/arch/arm/dts/ucm-imx95-u-boot.dtsi
index 4f25fef6ecb..3a08ca90c35 100644
--- a/arch/arm/dts/ucm-imx95-u-boot.dtsi
+++ b/arch/arm/dts/ucm-imx95-u-boot.dtsi
@@ -6,7 +6,7 @@
 / {
 	aliases {
 		ethernet0 = &enetc_port0;
-		ethernet1 = &enetc_port2;
+		ethernet1 = &enetc_port1;
 	};
 };
 
diff --git a/arch/arm/dts/ucm-imx95.dts b/arch/arm/dts/ucm-imx95.dts
index 289d6199454..6d7b8cf0726 100644
--- a/arch/arm/dts/ucm-imx95.dts
+++ b/arch/arm/dts/ucm-imx95.dts
@@ -175,26 +175,36 @@
 	status = "okay";
 };
 
-&enetc_port2 {
-	phy-handle = <&ethphy2>;
-	phy-mode = "usxgmii";
-	managed = "in-band-status";
+&enetc_port1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_enetc1>;
+	phy-handle = <&ethphy1>;
+	phy-mode = "rgmii-id";
+	status = "okay";
 };
 
 &netc_emdio {
+
 	ethphy0: ethernet-phy@1 {
+		compatible = "ethernet-phy-ieee802.3-c22";
 		reg = <1>;
 		eee-broken-1000t;
-#if 0
-		reset-gpios = <&i2c5_gpio_expander_21 2 GPIO_ACTIVE_LOW>;
+		reset-gpios = <&gpio5 13 GPIO_ACTIVE_LOW>;
 		reset-assert-us = <10000>;
 		reset-deassert-us = <80000>;
-#endif
+		realtek,clkout-disable;
 	};
 
-	ethphy2: ethernet-phy@8 {
-		reg = <8>;
-	};
+	ethphy1: ethernet-phy@4 {
+		compatible = "ethernet-phy-ieee802.3-c22";
+		reg = <4>;
+		eee-broken-1000t;
+		reset-gpios = <&gpio4 14 GPIO_ACTIVE_LOW>;
+		reset-assert-us = <10000>;
+		reset-deassert-us = <80000>;
+		realtek,clkout-disable;
+ 	};
+
 };
 
 &scmi_iomuxc {
@@ -270,6 +280,7 @@
 
 	pinctrl_enetc0: enetc0grp {
 		fsl,pins = <
+			IMX95_PAD_GPIO_IO33__GPIO5_IO_BIT13			0x3fe
 			IMX95_PAD_ENET1_MDC__NETCMIX_TOP_NETC_MDC		0x57e
 			IMX95_PAD_ENET1_MDIO__NETCMIX_TOP_NETC_MDIO		0x57e
 			IMX95_PAD_ENET1_TD3__NETCMIX_TOP_ETH0_RGMII_TD3		0x57e
@@ -289,6 +300,7 @@
 
 	pinctrl_enetc1: enetc1grp {
 		fsl,pins = <
+			IMX95_PAD_ENET2_MDC__GPIO4_IO_BIT14			0x3fe
 			IMX95_PAD_ENET2_TD3__NETCMIX_TOP_ETH1_RGMII_TD3		0x57e
 			IMX95_PAD_ENET2_TD2__NETCMIX_TOP_ETH1_RGMII_TD2		0x57e
 			IMX95_PAD_ENET2_TD1__NETCMIX_TOP_ETH1_RGMII_TD1		0x57e
